<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Konarak HRMS</title>

<!-- Tailwind (used only for spacing + responsiveness) -->
<script src="https://cdn.tailwindcss.com"></script>

<!-- SheetJS for Excel -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

<!-- jsPDF -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<!-- html2canvas -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

<style>
    body {
        background: #f3f4f6;
        font-family: Arial, sans-serif;
    }

    .section-title {
        font-size: 22px;
        font-weight: bold;
        margin-bottom: 15px;
    }

    .form-box {
        background: white;
        padding: 18px;
        border-radius: 10px;
        margin-bottom: 14px;
        border: 1px solid #e5e7eb;
    }

    .data-table th {
        background: #374151;
        color: white;
        padding: 10px;
        text-align: left;
    }

    .data-table td {
        padding: 10px;
        border-bottom: 1px solid #ddd;
        background: white;
    }

    .btn {
        padding: 10px 16px;
        border-radius: 8px;
        font-weight: bold;
    }

    .btn-primary {
        background: #2563eb;
        color: white;
    }

    .btn-danger {
        background: #dc2626;
        color: white;
    }

    .btn-secondary {
        background: #4b5563;
        color: white;
    }

</style>
</head>
<body class="p-6">

<!-----------------------------
     HEADER
------------------------------>
<div class="bg-white p-5 rounded-xl shadow mb-6">
    <h1 class="text-3xl font-bold">Konarak HRMS</h1>
    <p class="text-gray-600">LocalStorage HRMS • GitHub Pages Compatible</p>
</div>


<!-----------------------------
   EMPLOYEE FORM SECTION
------------------------------>
<div class="form-box">
    <div class="section-title">Add Employee</div>

    <div class="grid grid-cols-1 gap-4">

        <input id="empName" class="p-3 border rounded-lg" placeholder="Employee Full Name">

        <input id="empCode" class="p-3 border rounded-lg" placeholder="Employee Code (e.g., EMP1021)">

        <input id="empPhone" class="p-3 border rounded-lg" placeholder="Phone Number">

        <input id="empDesignation" class="p-3 border rounded-lg" placeholder="Designation">

        <input id="empSalary" type="number" class="p-3 border rounded-lg" placeholder="Basic Salary">

        <button onclick="addEmployee()" class="btn btn-primary w-full">Save Employee</button>
    </div>
</div>


<!-----------------------------
   EMPLOYEE DATA TABLE
------------------------------>
<div class="form-box">
    <div class="section-title">Employee List</div>

    <div class="flex gap-3 mb-4">
        <button onclick="exportEmployeesPDF()" class="btn btn-secondary">Export PDF</button>
        <button onclick="exportEmployeesExcel()" class="btn btn-primary">Export Excel</button>
        <button onclick="clearEmployees()" class="btn btn-danger">Clear All</button>
    </div>

    <div class="overflow-auto">
        <table class="data-table w-full" id="empTable">
            <thead>
                <tr>
                    <th>Name</th>
                    <th>Code</th>
                    <th>Phone</th>
                    <th>Designation</th>
                    <th>Salary</th>
                </tr>
            </thead>
            <tbody id="employeeBody"></tbody>
        </table>
    </div>
</div>



<script>
/* ==================================================
   LOCAL STORAGE BASE STRUCTURE
================================================== */
if (!localStorage.getItem("konarakEmployees")) {
    localStorage.setItem("konarakEmployees", JSON.stringify([]));
}

function loadEmployees() {
    return JSON.parse(localStorage.getItem("konarakEmployees"));
}

function saveEmployees(data) {
    localStorage.setItem("konarakEmployees", JSON.stringify(data));
}


/* ==================================================
   ADD EMPLOYEE
================================================== */
function addEmployee() {
    let name = document.getElementById("empName").value.trim();
    let code = document.getElementById("empCode").value.trim();
    let phone = document.getElementById("empPhone").value.trim();
    let desig = document.getElementById("empDesignation").value.trim();
    let salary = document.getElementById("empSalary").value.trim();

    if (!name || !code) {
        alert("Name & Code are mandatory!");
        return;
    }

    let employees = loadEmployees();

    employees.push({
        name, code, phone, desig, salary
    });

    saveEmployees(employees);
    renderEmployees();

    document.querySelectorAll("input").forEach(i => i.value = "");
}


/* ==================================================
   RENDER EMPLOYEE TABLE
================================================== */
function renderEmployees() {
    let employees = loadEmployees();
    let body = document.getElementById("employeeBody");
    body.innerHTML = "";

    employees.forEach(emp => {
        body.innerHTML += `
            <tr>
                <td>${emp.name}</td>
                <td>${emp.code}</td>
                <td>${emp.phone}</td>
                <td>${emp.desig}</td>
                <td>${emp.salary}</td>
            </tr>
        `;
    });
}

renderEmployees();


/* ==================================================
   EXPORT EMPLOYEES → EXCEL
================================================== */
function exportEmployeesExcel() {
    let employees = loadEmployees();
    let sheet = XLSX.utils.json_to_sheet(employees);
    let book = XLSX.utils.book_new();
    XLSX.utils.book_append_sheet(book, sheet, "Employees");
    XLSX.writeFile(book, "Employees.xlsx");
}


/* ==================================================
   EXPORT EMPLOYEES → PDF
================================================== */
async function exportEmployeesPDF() {
    const table = document.getElementById("empTable");

    const canvas = await html2canvas(table);
    const img = canvas.toDataURL("image/png");

    const { jsPDF } = window.jspdf;
    let pdf = new jsPDF('p', 'mm', 'a4');

    let width = pdf.internal.pageSize.getWidth() - 20;
    pdf.addImage(img, 'PNG', 10, 10, width, 0);

    pdf.save("Employees.pdf");
}


/* ==================================================
   CLEAR ALL EMPLOYEES
================================================== */
function clearEmployees() {
    if (confirm("Are you sure you want to delete all employees?")) {
        saveEmployees([]);
        renderEmployees();
    }
}
</script>

</body>
</html>
